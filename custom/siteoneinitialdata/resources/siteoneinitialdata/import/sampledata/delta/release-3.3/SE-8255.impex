## customer_restriction | Migration : Query Change
INSERT_UPDATE SearchRestriction; code[unique = true]  ; name[lang = en]               ; query                                                                                                                                                                                                                                                  ; principal(UID); restrictedType(code); active; generate
                              # ; customer_restriction ; Restrict customers visibility ; (EXISTS({{SELECT {unit:pk} FROM {B2BUnit as unit} WHERE {unit:pk} = {item:defaultb2bunit} AND {unit:path} LIKE CONCAT('/', CONCAT(substr_regexpr ('[^/]+' IN (?session.user.defaultb2bunit.path) FROM 1 OCCURRENCE 1), '%'))}})) ; b2bgroup      ; B2BCustomer         ; true  ; true
                                ; customer_restriction ; Restrict customers visibility ; (EXISTS({{SELECT {unit:pk} FROM {B2BUnit as unit} WHERE {unit:pk} = {item:defaultb2bunit} AND {unit:path} LIKE CONCAT(SUBSTRING(?session.user.defaultb2bunit.path,1, CASE when CHARINDEX('/',?session.user.defaultb2bunit.path,2)=0 then len(?session.user.defaultb2bunit.path) else CHARINDEX('/',?session.user.defaultb2bunit.path,2)-1 end),'%')}})) ; b2bgroup      ; B2BCustomer         ; true  ; true

