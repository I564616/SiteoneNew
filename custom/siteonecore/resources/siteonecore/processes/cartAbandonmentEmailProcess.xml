<?xml version="1.0" encoding="UTF-8"?>

<process xmlns="http://www.hybris.de/xsd/processdefinition"
         start="generateCartAbandonmentEmail"
         name="cartAbandonmentEmailProcess"
         processClass="com.siteone.core.model.CartAbandonmentEmailProcessModel"
         onError="error">
         
         <action id="generateCartAbandonmentEmail" bean="generateCartAbandonmentEmail">
        	<transition name="OK" to="sendEmail"/>
        	<transition name="NOK" to="error"/>
    	</action>
    	
    	<action id="sendEmail" bean="sendEmail">
        	<transition name="OK" to="cartAbandonmentEmailSent"/>
        	<transition name="NOK" to="failed"/>
    	</action>
    	
    	<action id="cartAbandonmentEmailSent" bean="cartAbandonmentEmailSent">
        	<transition name="OK" to="removeSentEmail"/>
    	</action>
    	
    	<action id="removeSentEmail" bean="removeSentEmail">
			<transition name="OK" to="success"/>
			<transition name="NOK" to="error"/>
		</action>
	
		<end id="error" state="ERROR">Something went wrong.</end>
		<end id="failed" state="FAILED">Could not send cart abandonment email.</end>
		<end id="success" state="SUCCEEDED">Sent cart abandonment email.</end>

</process>